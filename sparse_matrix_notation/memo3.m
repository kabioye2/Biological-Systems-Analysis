clc
clear
filename = 'Memo3_Excel.xlsx';
C1 = xlsread(filename, 'C1');
C2 = xlsread(filename, 'C2');
C3 = xlsread(filename, 'C3');
R = xlsread(filename, 'R');
resistance =
[22423,12457,143729,28391,17744330,2299666,2299665,17744339,2299668,2299667,2
299668,2299667,69,69,96,173];
% Part 2
A = [C1 R;(zeros(11,13)) C2;C3 (zeros(2,16))];
b = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;100;5];
x=A\b
r = (A*x)-b;
for i = 1:29
r(i)=(A(i,:)*x)-b(i);
end
test1P=(x(1)-x(2))-(resistance(1)*x(14));
test2P=(x(2)-x(3))-(resistance(2)*x(15));
test3P=(x(3)-x(4))-(resistance(3)*x(16));
test1F=(x(14)-x(15));
test2F=(x(15)-x(16)-x(17));
test3F=(x(16)-x(19)-x(18));
% Part 3
%matrix notation
S=spalloc(29,29,1000);
S(1,1)=1;S(1,2)=-1;S(2,2)=1;S(2,3)=-1;S(3,3)=1;S(3,4)=-1;S(4,3)=1;
S(4,6)=-1;S(5,4)=1;S(5,5)=-1;S(6,4)=1;S(6,7)=-1;S(7,6)=1;S(7,7)=-1;
S(8,6)=1;S(8,8)=-1;S(9,8)=1;S(9,10)=-1;S(10,7)=1;S(10,10)=-1;S(11,7)=1;
S(11,9)=-1;S(12,5)=1;S(12,9)=-1;S(13,9)=1;S(13,11)=-1;S(14,10)=1;
S(14,11)=-1;S(15,11)=1;S(15,12)=-1;S(16,12)=1;S(16,13)=-1;S(17,14)=1;
S(17,15)=-1;S(18,15)=1;S(18,16)=-1;S(18,17)=-1;S(19,16)=1;S(19,18)=-1;
S(19,19)=-1;S(20,18)=1;S(20,25)=-1;S(21,17)=1;S(21,20)=-1;S(21,21)=-1;
S(22,19)=1;S(22,20)=1;S(22,23)=-1;S(22,24)=-1;S(23,21)=1;S(23,22)=-1;
S(24,24)=1;S(24,25)=1;S(24,26)=-1;S(25,22)=1;S(25,23)=1;S(25,27)=-1;
S(26,26)=1;S(26,27)=1;S(26,28)=-1;S(27,28)=1;S(27,29)=-1;S(28,1)=1;
S(29,13)=1;S(1,14)=-22423;S(2,15)=-12457;S(3,16)=-143729;S(4,17)=-28391;
S(5,18)=-17744330;S(6,19)=-2299666;S(7,20)=-2299665;S(8,21)=-17744339;
S(9,22)=-2299668;S(10,23)=-2299667;S(11,24)=-2299668;S(12,25)=-2299667;
S(13,26)=-69;S(14,27)=-69;S(15,28)=-96;S(16,29)=-173;
% S-A must equal 0
x=S\b

